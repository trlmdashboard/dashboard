<!DOCTYPE html>
<html>
<head>
    <title>CSV Data Display</title>
    <style>
        table { border-collapse: collapse; margin: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
    </style>
</head>
<body>
    <div id="data-container"></div>

    <script>
        const csvUrl = "https://docs.google.com/spreadsheets/d/1CRjXmoPGnHvmNyIkkJ4LhPhke5j2ywUvgt5cD1P17VY/gviz/tq?tqx=out:csv&sheet=jsondata";

        async function loadCSVData() {
            try {
                const response = await fetch(csvUrl);
                const csvText = await response.text();
                
                // Parse CSV data
                const rows = csvText.split('\n');
                const headers = rows[0].split(',').map(header => header.trim());
                const data = rows.slice(1).map(row => {
                    const values = row.split(',');
                    return headers.reduce((obj, header, index) => {
                        obj[header] = values[index] ? values[index].trim() : '';
                        return obj;
                    }, {});
                });

                // Display data
                displayData(headers, data);
                
            } catch (error) {
                console.error('Error loading CSV:', error);
                document.getElementById('data-container').innerHTML = 
                    '<p>Error loading data: ' + error.message + '</p>';
            }
        }

        function displayData(headers, data) {
            const container = document.getElementById('data-container');
            
            // Create table
            let table = '<table>';
            
            // Create header row
            table += '<tr>';
            headers.forEach(header => {
                table += `<th>${header}</th>`;
            });
            table += '</tr>';
            
            // Create data rows
            data.forEach(row => {
                table += '<tr>';
                headers.forEach(header => {
                    table += `<td>${row[header] || ''}</td>`;
                });
                table += '</tr>';
            });
            
            table += '</table>';
            container.innerHTML = table;
        }

        // Load data when page loads
        loadCSVData();
    </script>
</body>
</html>
